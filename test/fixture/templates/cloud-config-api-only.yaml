#cloud-config
# yaml-language-server: $schema=https://raw.githubusercontent.com/canonical/cloud-init/main/cloudinit/config/schemas/versions.schema.cloud-config.json
# spell-checker: disable
---
write_files:
  - path: /etc/nginx/conf.d/default.conf
    permissions: '0644'
    owner: 'root:root'
    content: |
      server {
        listen       80 default_server;
        server_name  localhost;

        location / {
            root   /usr/share/nginx/html;
            index  index.html index.htm;
        }

        error_page   500 502 503 504  /50x.html;
        location = /50x.html {
            root   /usr/share/nginx/html;
        }
        location /api/ {
            api write=on;
            allow 127.0.0.1;
            deny all;
        }
      }
runcmd:
  - systemctl restart nginx
